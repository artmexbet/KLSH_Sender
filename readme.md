# KLSH_Sender
### Описание
Данное приложение позволяет отправлять письма
на почту людям, указанным в таблице excel,
подставляя следующие значения из этой таблицы:
+ Имя школьника
+ Направление (_если оно указано в формате Н*Н_)
+ Место или какое-то достижение, за которое он получил это письмо
### Инструкция по рассылке
Помимо этой инструкции есть справка прямо внутри
приложения. Однако здесь инструкция будет полнее.
#### Начало работы
Перед началом нужно удостовериться, что на Вашей почте
разрешено использование сторонних приложений. 
Для почты Google это можно узнать <a href="https://palpalych.ru/blog/nastrojka-otpravki-pochty-gmail-cherez-smtp-problemy-s-gsuite-i-smtp-storonnih-prilozhenij">так</a>.
#### Настройка приложения
После настройки почты можно начинать работу с приложением. <br>
Для начала, нужно ввести почту и пароль, выданный вам при разрешении работы
со сторонними приложениями, в предназначенные
для них окна в верхней части приложения. Почта будет сохранена,
пароль - нет, поэтому при каждом запуске приложения придётся
вводить пароль снова.<br>
После этого нужно указать все необходимые файлы
+ _html_ с содержанием письма и местами для подстановки данных (об этом ниже)
+ _xlsx_ файл с таблицей excel. При выборе _excel-файла_
  Вас попросят ввести номера колонок с данными для подстановки
  _(их следует вводить начиная с единицы)_ и название листа в файле
+ _txt_ файла с текстом, который будет отображён пользователю,
если его почтовый клиент не поддерживает html
### Правила написания шаблона письма
В целом, процесс написания письма не отличается от обычного.
Нужно просто сверстать в html письмо, которое будет отправлено.
Разница лишь в том, что в письме на местах, где должна будет находиться
подставляемая информация, нужно будет указать следующие строки:
+ _{{ name }}_ - имя школьника
+ _{{ dir }}_ - направление школьника (их может быть несколько,
они будут записаны через запятую)
+ _{{ place }}_ - достижение школьника. Их так же может быть несколько
<br>
**Важно: все указанные выше переменные должны быть указаны в
таком же виде (_и пробелы тоже_)**
<br>
#### Как работает подстановка нескольких достижений или направлений
Если в таблице, переданной в файл один и тот же школьник встречается
несколько раз, то его достижения и направления будут записаны через запятую.
### Окончание работы
После того как всё, описанное выше, будет выполнено, можно будет
выполнить рассылку. Для этого нужно нажать на большую кнопку
в нижней части приложения. Письма отправлены!
---
